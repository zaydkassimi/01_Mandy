module.exports=[6890,(a,b,c)=>{b.exports=a.x("cookie",()=>require("cookie"))},6187,(a,b,c)=>{b.exports=a.x("jsonwebtoken",()=>require("jsonwebtoken"))},5556,a=>{"use strict";var b=a.i(6187);a.i(6890);let c=process.env.JWT_SECRET||"dev-secret";function d(a){try{return b.default.verify(a,c)}catch(a){return null}}a.s(["verifyToken",()=>d])},1094,a=>{"use strict";var b=a.i(9168),c=a.i(7068),d=a.i(2759),e=a.i(3590),f=a.i(7342),g=a.i(8171),h=a.i(6890),i=a.i(5556),j=a.i(7669);function k({user:a}){let[b,c]=(0,j.useState)([]);async function d(a,b){await fetch("/api/attendance/approve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a,approved:b})}),c(c=>c.map(c=>c.id===a?{...c,approved:b}:c))}return(0,j.useEffect)(()=>{fetch("/api/attendance?all=1").then(a=>a.json()).then(a=>{a.ok&&c(a.attendances||[])})},[]),(0,g.jsxs)("main",{children:[(0,g.jsx)("h1",{children:"All Attendance"}),(0,g.jsxs)("div",{className:"card",children:[(0,g.jsxs)("p",{children:["Signed in as ",(0,g.jsx)("strong",{children:a.email})]}),(0,g.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Email"}),(0,g.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Action"}),(0,g.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Time"}),(0,g.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Geo"}),(0,g.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Photo"}),(0,g.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Approved"})]})}),(0,g.jsx)("tbody",{children:b.map(a=>(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f3f4f6"},children:a.email}),(0,g.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f3f4f6"},children:a.action}),(0,g.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f3f4f6"},children:new Date(a.timestamp).toLocaleString()}),(0,g.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f3f4f6"},children:a.lat?`${a.lat.toFixed(4)}, ${a.lng.toFixed(4)}`:"-"}),(0,g.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f3f4f6"},children:a.photo?(0,g.jsx)("img",{src:a.photo,style:{width:80,borderRadius:6}}):"-"}),(0,g.jsxs)("td",{style:{padding:8,borderBottom:"1px solid #f3f4f6"},children:[a.approved?"Yes":"No"," ",a.lateRequested?"(Late requested)":"",(0,g.jsxs)("div",{style:{marginTop:6},children:[!a.approved&&(0,g.jsx)("button",{className:"btn",onClick:()=>d(a.id,!0),children:"Approve"}),a.approved&&(0,g.jsx)("button",{className:"btn secondary",onClick:()=>d(a.id,!1),children:"Revoke"})]})]})]},a.id))})]})]})]})}function l({req:a}){let b=(a.headers.cookie?(0,h.parse)(a.headers.cookie||""):{}).token,c=b?(0,i.verifyToken)(b):null;return c&&"admin"===c.role?{props:{user:c}}:{redirect:{destination:"/",permanent:!1}}}a.s(["default",()=>k,"getServerSideProps",()=>l],5373);var m=a.i(5373),n=a.i(9193);let o=(0,d.hoist)(m,"default"),p=(0,d.hoist)(m,"getStaticProps"),q=(0,d.hoist)(m,"getStaticPaths"),r=(0,d.hoist)(m,"getServerSideProps"),s=(0,d.hoist)(m,"config"),t=(0,d.hoist)(m,"reportWebVitals"),u=(0,d.hoist)(m,"unstable_getStaticProps"),v=(0,d.hoist)(m,"unstable_getStaticPaths"),w=(0,d.hoist)(m,"unstable_getStaticParams"),x=(0,d.hoist)(m,"unstable_getServerProps"),y=(0,d.hoist)(m,"unstable_getServerSideProps"),z=new b.PagesRouteModule({definition:{kind:c.RouteKind.PAGES,page:"/admin/attendance",pathname:"/admin/attendance",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:f.default,Document:e.default},userland:m}),A=(0,n.getHandler)({srcPage:"/admin/attendance",config:s,userland:m,routeModule:z,getStaticPaths:q,getStaticProps:p,getServerSideProps:r});a.s(["config",0,s,"default",0,o,"getServerSideProps",0,r,"getStaticPaths",0,q,"getStaticProps",0,p,"handler",0,A,"reportWebVitals",0,t,"routeModule",0,z,"unstable_getServerProps",0,x,"unstable_getServerSideProps",0,y,"unstable_getStaticParams",0,w,"unstable_getStaticPaths",0,v,"unstable_getStaticProps",0,u],1094)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__2f1bb192._.js.map