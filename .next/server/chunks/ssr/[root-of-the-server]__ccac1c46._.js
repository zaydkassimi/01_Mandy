module.exports=[6890,(a,b,c)=>{b.exports=a.x("cookie",()=>require("cookie"))},6187,(a,b,c)=>{b.exports=a.x("jsonwebtoken",()=>require("jsonwebtoken"))},5556,a=>{"use strict";var b=a.i(6187);a.i(6890);let c=process.env.JWT_SECRET||"dev-secret";function d(a){try{return b.default.verify(a,c)}catch(a){return null}}a.s(["verifyToken",()=>d])},7057,a=>{"use strict";var b=a.i(2734);let c=a.i(4747).default.join(process.cwd(),"data","db.json");async function d(){return JSON.parse(await b.default.promises.readFile(c,"utf-8"))}async function e(){let a=await d();return a.attendances||(a.attendances=[]),a.attendances}async function f(){return(await d()).users||[]}async function g(){let a=await d();return a.shifts=a.shifts||[],a.shifts}async function h(){let a=await d();return a.expenses=a.expenses||[],a.expenses}a.s(["getAllAttendances",()=>e,"listExpenses",()=>h,"listShifts",()=>g,"listUsers",()=>f])},2712,a=>{"use strict";var b=a.i(9168),c=a.i(7068),d=a.i(2759),e=a.i(3590),f=a.i(7342),g=a.i(8171),h=a.i(6890),i=a.i(5556),j=a.i(7057);function k({user:a,stats:b}){return a&&"admin"===a.role?(0,g.jsxs)("main",{children:[(0,g.jsxs)("div",{className:"page-header",children:[(0,g.jsx)("h1",{children:"Admin Dashboard"}),(0,g.jsx)("p",{className:"small",children:"Overview of staff, shifts, attendance and expenses."})]}),(0,g.jsxs)("section",{className:"stats-grid","aria-label":"Key metrics",children:[(0,g.jsxs)("div",{className:"card stat-card",children:[(0,g.jsxs)("div",{className:"stat-top",children:[(0,g.jsx)("div",{className:"small",children:"Total staff"}),(0,g.jsx)("div",{className:"stat-value",children:b.totalUsers})]}),(0,g.jsx)("div",{children:(0,g.jsx)("a",{href:"/admin/staff",className:"btn",children:"Manage Staff"})})]}),(0,g.jsxs)("div",{className:"card stat-card",children:[(0,g.jsxs)("div",{className:"stat-top",children:[(0,g.jsx)("div",{className:"small",children:"Total shifts"}),(0,g.jsx)("div",{className:"stat-value",children:b.totalShifts})]}),(0,g.jsx)("div",{children:(0,g.jsx)("a",{href:"/admin/shifts",className:"btn",children:"Manage Shifts"})})]}),(0,g.jsxs)("div",{className:"card stat-card",children:[(0,g.jsxs)("div",{className:"stat-top",children:[(0,g.jsx)("div",{className:"small",children:"Attendance records"}),(0,g.jsx)("div",{className:"stat-value",children:b.totalAttendances})]}),(0,g.jsx)("div",{children:(0,g.jsx)("a",{href:"/admin/attendance",className:"btn secondary",children:"View Attendance"})})]}),(0,g.jsxs)("div",{className:"card stat-card",children:[(0,g.jsxs)("div",{className:"stat-top",children:[(0,g.jsx)("div",{className:"small",children:"Total expenses"}),(0,g.jsxs)("div",{className:"stat-value",children:["Â£",Number(b.expenseTotal).toFixed(2)]})]}),(0,g.jsx)("div",{children:(0,g.jsx)("a",{href:"/admin/expenses",className:"btn",children:"Expenses"})})]})]}),(0,g.jsx)("section",{style:{marginTop:28},children:(0,g.jsxs)("div",{className:"card welcome-card",children:[(0,g.jsxs)("h3",{style:{margin:0},children:["Welcome, ",(0,g.jsx)("strong",{children:a.email})]}),(0,g.jsx)("p",{className:"small",style:{marginTop:10},children:"Use the tiles above to manage staff, shifts, attendance and expenses. Visit the Export page to download data."})]})})]}):(0,g.jsx)("main",{children:(0,g.jsx)("h1",{children:"403 - forbidden"})})}async function l({req:a}){let b=(a.headers.cookie?(0,h.parse)(a.headers.cookie||""):{}).token,c=b?(0,i.verifyToken)(b):null;if(!c||"admin"!==c.role)return{redirect:{destination:"/",permanent:!1}};let d=await (0,j.listUsers)(),e=await (0,j.listShifts)(),f=await (0,j.getAllAttendances)(),g=await (0,j.listExpenses)();return{props:{user:c,stats:{totalUsers:(d||[]).length,totalShifts:(e||[]).length,totalAttendances:(f||[]).length,expenseTotal:(g||[]).reduce((a,b)=>a+Number(b.amount||0),0)}}}}a.s(["default",()=>k,"getServerSideProps",()=>l],1392);var m=a.i(1392),n=a.i(9193);let o=(0,d.hoist)(m,"default"),p=(0,d.hoist)(m,"getStaticProps"),q=(0,d.hoist)(m,"getStaticPaths"),r=(0,d.hoist)(m,"getServerSideProps"),s=(0,d.hoist)(m,"config"),t=(0,d.hoist)(m,"reportWebVitals"),u=(0,d.hoist)(m,"unstable_getStaticProps"),v=(0,d.hoist)(m,"unstable_getStaticPaths"),w=(0,d.hoist)(m,"unstable_getStaticParams"),x=(0,d.hoist)(m,"unstable_getServerProps"),y=(0,d.hoist)(m,"unstable_getServerSideProps"),z=new b.PagesRouteModule({definition:{kind:c.RouteKind.PAGES,page:"/admin/index",pathname:"/admin",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:f.default,Document:e.default},userland:m}),A=(0,n.getHandler)({srcPage:"/admin/index",config:s,userland:m,routeModule:z,getStaticPaths:q,getStaticProps:p,getServerSideProps:r});a.s(["config",0,s,"default",0,o,"getServerSideProps",0,r,"getStaticPaths",0,q,"getStaticProps",0,p,"handler",0,A,"reportWebVitals",0,t,"routeModule",0,z,"unstable_getServerProps",0,x,"unstable_getServerSideProps",0,y,"unstable_getStaticParams",0,w,"unstable_getStaticPaths",0,v,"unstable_getStaticProps",0,u],2712)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ccac1c46._.js.map