module.exports=[6890,(a,b,c)=>{b.exports=a.x("cookie",()=>require("cookie"))},6187,(a,b,c)=>{b.exports=a.x("jsonwebtoken",()=>require("jsonwebtoken"))},5556,a=>{"use strict";var b=a.i(6187);a.i(6890);let c=process.env.JWT_SECRET||"dev-secret";function d(a){try{return b.default.verify(a,c)}catch(a){return null}}a.s(["verifyToken",()=>d])},7801,a=>{"use strict";var b=a.i(9168),c=a.i(7068),d=a.i(2759),e=a.i(3590),f=a.i(7342),g=a.i(8171),h=a.i(7669),i=a.i(6890),j=a.i(5556);function k(a){let b=a.getFullYear(),c=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0");return`${b}-${c}-${d}`}function l({user:a}){let[b,c]=(0,h.useState)(()=>{let a=new Date;return a.setDate(1),a}),[d,e]=(0,h.useState)({});async function f(a){let c=new Date(b);c.setDate(a);let f=k(c),g=d[f],h=void 0===g?"available":"available"===g?"unavailable":void 0;await fetch("/api/availability",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:f,status:h})}),e(a=>{let b={...a};return h?b[f]=h:delete b[f],b})}(0,h.useEffect)(()=>{fetch("/api/availability").then(a=>a.json()).then(a=>{if(a.ok){let b={};for(let c of a.availabilities||[])b[c.date]=c.status;e(b)}})},[]);let i=b.getFullYear(),j=b.getMonth(),l=new Date(b.getFullYear(),b.getMonth()+1,0).getDate(),m=Array.from({length:new Date(i,j,1).getDay()}).map((a,b)=>(0,g.jsx)("div",{},"b"+b)),n=Array.from({length:l}).map((a,b)=>{let c=b+1,e=k(new Date(i,j,c)),h=d[e];return(0,g.jsxs)("div",{style:{padding:8,borderRadius:6,cursor:"pointer",background:"available"===h?"#d1fae5":"unavailable"===h?"#fee2e2":"white",border:"1px solid #e5e7eb",textAlign:"center"},onClick:()=>f(c),children:[(0,g.jsx)("div",{style:{fontSize:12},children:c}),(0,g.jsx)("div",{style:{fontSize:11,color:"#374151"},children:"available"===h?"Available":"unavailable"===h?"Unavailable":""})]},e)});return(0,g.jsxs)("main",{children:[(0,g.jsxs)("h1",{children:[a?.email,"'s Availability Calendar"]}),(0,g.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12},children:[(0,g.jsx)("button",{className:"btn secondary",onClick:function(){let a=new Date(b);a.setMonth(a.getMonth()-1),c(a)},children:"Prev"}),(0,g.jsx)("div",{style:{alignSelf:"center",fontWeight:600},children:b.toLocaleString(void 0,{month:"long",year:"numeric"})}),(0,g.jsx)("button",{className:"btn",onClick:function(){let a=new Date(b);a.setMonth(a.getMonth()+1),c(a)},children:"Next"})]}),(0,g.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(7,1fr)",gap:8},children:[(0,g.jsx)("div",{style:{fontWeight:600},children:"Sun"}),(0,g.jsx)("div",{style:{fontWeight:600},children:"Mon"}),(0,g.jsx)("div",{style:{fontWeight:600},children:"Tue"}),(0,g.jsx)("div",{style:{fontWeight:600},children:"Wed"}),(0,g.jsx)("div",{style:{fontWeight:600},children:"Thu"}),(0,g.jsx)("div",{style:{fontWeight:600},children:"Fri"}),(0,g.jsx)("div",{style:{fontWeight:600},children:"Sat"}),m,n]}),(0,g.jsxs)("p",{style:{marginTop:12},children:[(0,g.jsx)("strong",{children:"How to use:"})," Click a date to mark Available (green), click again to mark Unavailable (red), click again to clear."]})]})}function m({req:a}){let b=(a.headers.cookie?(0,i.parse)(a.headers.cookie||""):{}).token,c=b?(0,j.verifyToken)(b):null;return c?"admin"===c.role?{redirect:{destination:"/admin",permanent:!1}}:{props:{user:c}}:{redirect:{destination:"/login",permanent:!1}}}a.s(["default",()=>l,"getServerSideProps",()=>m],1131);var n=a.i(1131),o=a.i(9193);let p=(0,d.hoist)(n,"default"),q=(0,d.hoist)(n,"getStaticProps"),r=(0,d.hoist)(n,"getStaticPaths"),s=(0,d.hoist)(n,"getServerSideProps"),t=(0,d.hoist)(n,"config"),u=(0,d.hoist)(n,"reportWebVitals"),v=(0,d.hoist)(n,"unstable_getStaticProps"),w=(0,d.hoist)(n,"unstable_getStaticPaths"),x=(0,d.hoist)(n,"unstable_getStaticParams"),y=(0,d.hoist)(n,"unstable_getServerProps"),z=(0,d.hoist)(n,"unstable_getServerSideProps"),A=new b.PagesRouteModule({definition:{kind:c.RouteKind.PAGES,page:"/calendar",pathname:"/calendar",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:f.default,Document:e.default},userland:n}),B=(0,o.getHandler)({srcPage:"/calendar",config:t,userland:n,routeModule:A,getStaticPaths:r,getStaticProps:q,getServerSideProps:s});a.s(["config",0,t,"default",0,p,"getServerSideProps",0,s,"getStaticPaths",0,r,"getStaticProps",0,q,"handler",0,B,"reportWebVitals",0,u,"routeModule",0,A,"unstable_getServerProps",0,y,"unstable_getServerSideProps",0,z,"unstable_getStaticParams",0,x,"unstable_getStaticPaths",0,w,"unstable_getStaticProps",0,v],7801)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__11309245._.js.map