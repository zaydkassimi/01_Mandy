module.exports=[6890,(a,b,c)=>{b.exports=a.x("cookie",()=>require("cookie"))},6187,(a,b,c)=>{b.exports=a.x("jsonwebtoken",()=>require("jsonwebtoken"))},5556,a=>{"use strict";var b=a.i(6187);a.i(6890);let c=process.env.JWT_SECRET||"dev-secret";function d(a){try{return b.default.verify(a,c)}catch(a){return null}}a.s(["verifyToken",()=>d])},6143,a=>{"use strict";var b=a.i(9168),c=a.i(7068),d=a.i(2759),e=a.i(3590),f=a.i(7342),g=a.i(8171),h=a.i(6890),i=a.i(5556),j=a.i(7669);function k({user:a}){let[b,c]=(0,j.useState)([]),[d,e]=(0,j.useState)(""),[f,h]=(0,j.useState)(""),[i,k]=(0,j.useState)("employee");async function l(){await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,password:f,role:i})}),e(""),h("");let a=await fetch("/api/admin/users"),b=await a.json();b.ok&&c(b.users||[])}async function m(a){confirm("Delete user "+a+"?")&&(await fetch("/api/admin/users",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})}),c(b=>b.filter(b=>b.email!==a)))}return(0,j.useEffect)(()=>{fetch("/api/admin/users").then(a=>a.json()).then(a=>{a.ok&&c(a.users||[])})},[]),(0,g.jsxs)("main",{children:[(0,g.jsx)("h1",{children:"Manage Staff"}),(0,g.jsxs)("div",{className:"card",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("input",{placeholder:"email",value:d,onChange:a=>e(a.target.value)})," ",(0,g.jsx)("input",{placeholder:"password",value:f,onChange:a=>h(a.target.value)}),(0,g.jsxs)("select",{value:i,onChange:a=>k(a.target.value),style:{marginLeft:8},children:[(0,g.jsx)("option",{value:"employee",children:"employee"}),(0,g.jsx)("option",{value:"admin",children:"admin"})]}),(0,g.jsx)("button",{className:"btn",onClick:l,style:{marginLeft:8},children:"Add"})]}),(0,g.jsxs)("table",{style:{width:"100%",marginTop:12},children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{children:"Email"}),(0,g.jsx)("th",{children:"Role"}),(0,g.jsx)("th",{children:"Action"})]})}),(0,g.jsx)("tbody",{children:b.map(a=>(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{style:{padding:8},children:a.email}),(0,g.jsx)("td",{style:{padding:8},children:a.role}),(0,g.jsx)("td",{style:{padding:8},children:(0,g.jsx)("button",{className:"btn secondary",onClick:()=>m(a.email),children:"Delete"})})]},a.email))})]})]})]})}function l({req:a}){let b=(a.headers.cookie?(0,h.parse)(a.headers.cookie||""):{}).token,c=b?(0,i.verifyToken)(b):null;return c&&"admin"===c.role?{props:{user:c}}:{redirect:{destination:"/",permanent:!1}}}a.s(["default",()=>k,"getServerSideProps",()=>l],2670);var m=a.i(2670),n=a.i(9193);let o=(0,d.hoist)(m,"default"),p=(0,d.hoist)(m,"getStaticProps"),q=(0,d.hoist)(m,"getStaticPaths"),r=(0,d.hoist)(m,"getServerSideProps"),s=(0,d.hoist)(m,"config"),t=(0,d.hoist)(m,"reportWebVitals"),u=(0,d.hoist)(m,"unstable_getStaticProps"),v=(0,d.hoist)(m,"unstable_getStaticPaths"),w=(0,d.hoist)(m,"unstable_getStaticParams"),x=(0,d.hoist)(m,"unstable_getServerProps"),y=(0,d.hoist)(m,"unstable_getServerSideProps"),z=new b.PagesRouteModule({definition:{kind:c.RouteKind.PAGES,page:"/admin/staff",pathname:"/admin/staff",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:f.default,Document:e.default},userland:m}),A=(0,n.getHandler)({srcPage:"/admin/staff",config:s,userland:m,routeModule:z,getStaticPaths:q,getStaticProps:p,getServerSideProps:r});a.s(["config",0,s,"default",0,o,"getServerSideProps",0,r,"getStaticPaths",0,q,"getStaticProps",0,p,"handler",0,A,"reportWebVitals",0,t,"routeModule",0,z,"unstable_getServerProps",0,x,"unstable_getServerSideProps",0,y,"unstable_getStaticParams",0,w,"unstable_getStaticPaths",0,v,"unstable_getStaticProps",0,u],6143)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__b34f9759._.js.map