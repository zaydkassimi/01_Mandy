{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Zayd/Desktop/01_Mandy/lib/auth.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\r\nimport { serialize } from \"cookie\";\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || \"dev-secret\";\r\n\r\nexport function signToken(payload) {\r\n  return jwt.sign(payload, JWT_SECRET, { expiresIn: \"8h\" });\r\n}\r\n\r\nexport function verifyToken(token) {\r\n  try {\r\n    return jwt.verify(token, JWT_SECRET);\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function setTokenCookie(res, token) {\r\n  const cookie = serialize(\"token\", token, {\r\n    httpOnly: true,\r\n    path: \"/\",\r\n    maxAge: 60 * 60 * 8\r\n  });\r\n  res.setHeader(\"Set-Cookie\", cookie);\r\n}\r\n\r\nexport function clearTokenCookie(res) {\r\n  const cookie = serialize(\"token\", \"\", {\r\n    httpOnly: true,\r\n    path: \"/\",\r\n    maxAge: 0\r\n  });\r\n  res.setHeader(\"Set-Cookie\", cookie);\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,SAAS,UAAU,OAAO;IAC/B,OAAO,4HAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAK;AACzD;AAEO,SAAS,YAAY,KAAK;IAC/B,IAAI;QACF,OAAO,4HAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAO,GAAG;QACV,OAAO;IACT;AACF;AAEO,SAAS,eAAe,GAAG,EAAE,KAAK;IACvC,MAAM,SAAS,IAAA,kHAAS,EAAC,SAAS,OAAO;QACvC,UAAU;QACV,MAAM;QACN,QAAQ,KAAK,KAAK;IACpB;IACA,IAAI,SAAS,CAAC,cAAc;AAC9B;AAEO,SAAS,iBAAiB,GAAG;IAClC,MAAM,SAAS,IAAA,kHAAS,EAAC,SAAS,IAAI;QACpC,UAAU;QACV,MAAM;QACN,QAAQ;IACV;IACA,IAAI,SAAS,CAAC,cAAc;AAC9B"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Zayd/Desktop/01_Mandy/pages/admin/index.js"],"sourcesContent":["import { parse } from \"cookie\";\r\nimport { verifyToken } from \"../../lib/auth\";\r\n\r\nexport default function Admin({ user }) {\r\n  if (!user || user.role !== \"admin\") {\r\n    return <main><h1>403 - forbidden</h1></main>;\r\n  }\r\n  return (\r\n    <main>\r\n      <h1>Admin Dashboard</h1>\r\n      <div className=\"card\">\r\n        <p>Welcome, <strong>{user.email}</strong></p>\r\n        <p>This is a minimal admin dashboard. Quick links:</p>\r\n        <ul>\r\n          <li><a href=\"/admin/attendance\" className=\"btn secondary\">View Attendance</a></li>\r\n          <li style={{ marginTop: 8 }}><a href=\"/admin/staff\" className=\"btn secondary\">Manage Staff (TODO)</a></li>\r\n        </ul>\r\n        <p style={{ marginTop: 8 }}>Next steps: manage shifts, expenses, exports.</p>\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n\r\nexport function getServerSideProps({ req }) {\r\n  const cookies = req.headers.cookie ? parse(req.headers.cookie || \"\") : {};\r\n  const token = cookies.token;\r\n  const user = token ? verifyToken(token) : null;\r\n  return { props: { user } };\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;;;;AAEe,SAAS,MAAM,EAAE,IAAI,EAAE;IACpC,IAAI,CAAC,QAAQ,KAAK,IAAI,KAAK,SAAS;QAClC,qBAAO,qKAAC;sBAAK,cAAA,qKAAC;0BAAG;;;;;;;;;;;IACnB;IACA,qBACE,qKAAC;;0BACC,qKAAC;0BAAG;;;;;;0BACJ,qKAAC;gBAAI,WAAU;;kCACb,qKAAC;;4BAAE;0CAAS,qKAAC;0CAAQ,KAAK,KAAK;;;;;;;;;;;;kCAC/B,qKAAC;kCAAE;;;;;;kCACH,qKAAC;;0CACC,qKAAC;0CAAG,cAAA,qKAAC;oCAAE,MAAK;oCAAoB,WAAU;8CAAgB;;;;;;;;;;;0CAC1D,qKAAC;gCAAG,OAAO;oCAAE,WAAW;gCAAE;0CAAG,cAAA,qKAAC;oCAAE,MAAK;oCAAe,WAAU;8CAAgB;;;;;;;;;;;;;;;;;kCAEhF,qKAAC;wBAAE,OAAO;4BAAE,WAAW;wBAAE;kCAAG;;;;;;;;;;;;;;;;;;AAIpC;AAEO,SAAS,mBAAmB,EAAE,GAAG,EAAE;IACxC,MAAM,UAAU,IAAI,OAAO,CAAC,MAAM,GAAG,IAAA,8GAAK,EAAC,IAAI,OAAO,CAAC,MAAM,IAAI,MAAM,CAAC;IACxE,MAAM,QAAQ,QAAQ,KAAK;IAC3B,MAAM,OAAO,QAAQ,IAAA,mHAAW,EAAC,SAAS;IAC1C,OAAO;QAAE,OAAO;YAAE;QAAK;IAAE;AAC3B"}}]
}