{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Zayd/Desktop/01_Mandy/lib/auth.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\r\nimport { serialize } from \"cookie\";\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || \"dev-secret\";\r\n\r\nexport function signToken(payload) {\r\n  return jwt.sign(payload, JWT_SECRET, { expiresIn: \"8h\" });\r\n}\r\n\r\nexport function verifyToken(token) {\r\n  try {\r\n    return jwt.verify(token, JWT_SECRET);\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function setTokenCookie(res, token) {\r\n  const cookie = serialize(\"token\", token, {\r\n    httpOnly: true,\r\n    path: \"/\",\r\n    maxAge: 60 * 60 * 8\r\n  });\r\n  res.setHeader(\"Set-Cookie\", cookie);\r\n}\r\n\r\nexport function clearTokenCookie(res) {\r\n  const cookie = serialize(\"token\", \"\", {\r\n    httpOnly: true,\r\n    path: \"/\",\r\n    maxAge: 0\r\n  });\r\n  res.setHeader(\"Set-Cookie\", cookie);\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,SAAS,UAAU,OAAO;IAC/B,OAAO,4HAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAK;AACzD;AAEO,SAAS,YAAY,KAAK;IAC/B,IAAI;QACF,OAAO,4HAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAO,GAAG;QACV,OAAO;IACT;AACF;AAEO,SAAS,eAAe,GAAG,EAAE,KAAK;IACvC,MAAM,SAAS,IAAA,kHAAS,EAAC,SAAS,OAAO;QACvC,UAAU;QACV,MAAM;QACN,QAAQ,KAAK,KAAK;IACpB;IACA,IAAI,SAAS,CAAC,cAAc;AAC9B;AAEO,SAAS,iBAAiB,GAAG;IAClC,MAAM,SAAS,IAAA,kHAAS,EAAC,SAAS,IAAI;QACpC,UAAU;QACV,MAAM;QACN,QAAQ;IACV;IACA,IAAI,SAAS,CAAC,cAAc;AAC9B"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Zayd/Desktop/01_Mandy/pages/admin/export.js"],"sourcesContent":["import { parse } from \"cookie\";\r\nimport { verifyToken } from \"../../lib/auth\";\r\n\r\nexport default function AdminExport({ user }) {\r\n  function download(type, fmt = \"csv\") {\r\n    if (fmt === \"csv\") window.location.href = `/api/export?type=${type}`;\r\n    if (fmt === \"xlsx\") window.location.href = `/api/export_xlsx?type=${type}`;\r\n    if (fmt === \"docx\") window.location.href = `/api/export_docx?type=${type}`;\r\n  }\r\n\r\n  const tiles = [\r\n    { key: \"users\", title: \"Users\", desc: \"All staff accounts and roles\", emoji: \"ðŸ‘¥\" },\r\n    { key: \"attendances\", title: \"Attendance\", desc: \"Check-in/out records with location & photo\", emoji: \"ðŸ•˜\" },\r\n    { key: \"shifts\", title: \"Shifts\", desc: \"Scheduled shifts and times\", emoji: \"ðŸ“…\" },\r\n    { key: \"expenses\", title: \"Expenses\", desc: \"Recorded expenses (GBP)\", emoji: \"ðŸ’·\" }\r\n  ];\r\n\r\n  return (\r\n    <main>\r\n      <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"space-between\", gap: 12 }}>\r\n        <h1>Export Data</h1>\r\n        <div className=\"small\">Signed in as <strong>{user.email}</strong></div>\r\n      </div>\r\n\r\n      <div className=\"card\" style={{ marginTop: 12 }}>\r\n        <p className=\"small\">Select the dataset and format you want to export. CSV is good for spreadsheets, XLSX for richer Excel use, DOCX for readable reports.</p>\r\n\r\n        <div className=\"export-grid\" style={{ marginTop: 18 }}>\r\n          {tiles.map((t) => (\r\n            <div className=\"export-tile card\" key={t.key}>\r\n              <div style={{ display: \"flex\", alignItems: \"center\", gap: 12 }}>\r\n                <div style={{ fontSize: 28 }}>{t.emoji}</div>\r\n                <div>\r\n                  <div style={{ fontWeight: 700 }}>{t.title}</div>\r\n                  <div className=\"small\">{t.desc}</div>\r\n                </div>\r\n              </div>\r\n\r\n              <div style={{ marginTop: 12, display: \"flex\", gap: 8 }}>\r\n                <button className=\"btn\" onClick={() => download(t.key, \"csv\")}>CSV</button>\r\n                <button className=\"btn secondary\" onClick={() => download(t.key, \"xlsx\")}>XLSX</button>\r\n                <button className=\"btn\" onClick={() => download(t.key, \"docx\")}>DOCX</button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n\r\nexport function getServerSideProps({ req }) {\r\n  const cookies = req.headers.cookie ? parse(req.headers.cookie || \"\") : {};\r\n  const token = cookies.token;\r\n  const user = token ? verifyToken(token) : null;\r\n  if (!user || user.role !== \"admin\") {\r\n    return { redirect: { destination: \"/\", permanent: false } };\r\n  }\r\n  return { props: { user } };\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;;;;AAEe,SAAS,YAAY,EAAE,IAAI,EAAE;IAC1C,SAAS,SAAS,IAAI,EAAE,MAAM,KAAK;QACjC,IAAI,QAAQ,OAAO,OAAO,QAAQ,CAAC,IAAI,GAAG,CAAC,iBAAiB,EAAE,MAAM;QACpE,IAAI,QAAQ,QAAQ,OAAO,QAAQ,CAAC,IAAI,GAAG,CAAC,sBAAsB,EAAE,MAAM;QAC1E,IAAI,QAAQ,QAAQ,OAAO,QAAQ,CAAC,IAAI,GAAG,CAAC,sBAAsB,EAAE,MAAM;IAC5E;IAEA,MAAM,QAAQ;QACZ;YAAE,KAAK;YAAS,OAAO;YAAS,MAAM;YAAgC,OAAO;QAAK;QAClF;YAAE,KAAK;YAAe,OAAO;YAAc,MAAM;YAA8C,OAAO;QAAK;QAC3G;YAAE,KAAK;YAAU,OAAO;YAAU,MAAM;YAA8B,OAAO;QAAK;QAClF;YAAE,KAAK;YAAY,OAAO;YAAY,MAAM;YAA2B,OAAO;QAAK;KACpF;IAED,qBACE,qKAAC;;0BACC,qKAAC;gBAAI,OAAO;oBAAE,SAAS;oBAAQ,YAAY;oBAAU,gBAAgB;oBAAiB,KAAK;gBAAG;;kCAC5F,qKAAC;kCAAG;;;;;;kCACJ,qKAAC;wBAAI,WAAU;;4BAAQ;0CAAa,qKAAC;0CAAQ,KAAK,KAAK;;;;;;;;;;;;;;;;;;0BAGzD,qKAAC;gBAAI,WAAU;gBAAO,OAAO;oBAAE,WAAW;gBAAG;;kCAC3C,qKAAC;wBAAE,WAAU;kCAAQ;;;;;;kCAErB,qKAAC;wBAAI,WAAU;wBAAc,OAAO;4BAAE,WAAW;wBAAG;kCACjD,MAAM,GAAG,CAAC,CAAC,kBACV,qKAAC;gCAAI,WAAU;;kDACb,qKAAC;wCAAI,OAAO;4CAAE,SAAS;4CAAQ,YAAY;4CAAU,KAAK;wCAAG;;0DAC3D,qKAAC;gDAAI,OAAO;oDAAE,UAAU;gDAAG;0DAAI,EAAE,KAAK;;;;;;0DACtC,qKAAC;;kEACC,qKAAC;wDAAI,OAAO;4DAAE,YAAY;wDAAI;kEAAI,EAAE,KAAK;;;;;;kEACzC,qKAAC;wDAAI,WAAU;kEAAS,EAAE,IAAI;;;;;;;;;;;;;;;;;;kDAIlC,qKAAC;wCAAI,OAAO;4CAAE,WAAW;4CAAI,SAAS;4CAAQ,KAAK;wCAAE;;0DACnD,qKAAC;gDAAO,WAAU;gDAAM,SAAS,IAAM,SAAS,EAAE,GAAG,EAAE;0DAAQ;;;;;;0DAC/D,qKAAC;gDAAO,WAAU;gDAAgB,SAAS,IAAM,SAAS,EAAE,GAAG,EAAE;0DAAS;;;;;;0DAC1E,qKAAC;gDAAO,WAAU;gDAAM,SAAS,IAAM,SAAS,EAAE,GAAG,EAAE;0DAAS;;;;;;;;;;;;;+BAZ7B,EAAE,GAAG;;;;;;;;;;;;;;;;;;;;;;AAoBxD;AAEO,SAAS,mBAAmB,EAAE,GAAG,EAAE;IACxC,MAAM,UAAU,IAAI,OAAO,CAAC,MAAM,GAAG,IAAA,8GAAK,EAAC,IAAI,OAAO,CAAC,MAAM,IAAI,MAAM,CAAC;IACxE,MAAM,QAAQ,QAAQ,KAAK;IAC3B,MAAM,OAAO,QAAQ,IAAA,mHAAW,EAAC,SAAS;IAC1C,IAAI,CAAC,QAAQ,KAAK,IAAI,KAAK,SAAS;QAClC,OAAO;YAAE,UAAU;gBAAE,aAAa;gBAAK,WAAW;YAAM;QAAE;IAC5D;IACA,OAAO;QAAE,OAAO;YAAE;QAAK;IAAE;AAC3B"}}]
}