{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Zayd/Desktop/01_Mandy/lib/auth.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\r\nimport { serialize } from \"cookie\";\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || \"dev-secret\";\r\n\r\nexport function signToken(payload) {\r\n  return jwt.sign(payload, JWT_SECRET, { expiresIn: \"8h\" });\r\n}\r\n\r\nexport function verifyToken(token) {\r\n  try {\r\n    return jwt.verify(token, JWT_SECRET);\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function setTokenCookie(res, token) {\r\n  const cookie = serialize(\"token\", token, {\r\n    httpOnly: true,\r\n    path: \"/\",\r\n    maxAge: 60 * 60 * 8\r\n  });\r\n  res.setHeader(\"Set-Cookie\", cookie);\r\n}\r\n\r\nexport function clearTokenCookie(res) {\r\n  const cookie = serialize(\"token\", \"\", {\r\n    httpOnly: true,\r\n    path: \"/\",\r\n    maxAge: 0\r\n  });\r\n  res.setHeader(\"Set-Cookie\", cookie);\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,SAAS,UAAU,OAAO;IAC/B,OAAO,4HAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAK;AACzD;AAEO,SAAS,YAAY,KAAK;IAC/B,IAAI;QACF,OAAO,4HAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAO,GAAG;QACV,OAAO;IACT;AACF;AAEO,SAAS,eAAe,GAAG,EAAE,KAAK;IACvC,MAAM,SAAS,IAAA,kHAAS,EAAC,SAAS,OAAO;QACvC,UAAU;QACV,MAAM;QACN,QAAQ,KAAK,KAAK;IACpB;IACA,IAAI,SAAS,CAAC,cAAc;AAC9B;AAEO,SAAS,iBAAiB,GAAG;IAClC,MAAM,SAAS,IAAA,kHAAS,EAAC,SAAS,IAAI;QACpC,UAAU;QACV,MAAM;QACN,QAAQ;IACV;IACA,IAAI,SAAS,CAAC,cAAc;AAC9B"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Zayd/Desktop/01_Mandy/pages/admin/staff.js"],"sourcesContent":["import { parse } from \"cookie\";\r\nimport { verifyToken } from \"../../lib/auth\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\nexport default function AdminStaff({ user }) {\r\n  const [users, setUsers] = useState([]);\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [role, setRole] = useState(\"employee\");\r\n\r\n  useEffect(() => {\r\n    fetch(\"/api/admin/users\").then((r) => r.json()).then((d) => { if (d.ok) setUsers(d.users || []); });\r\n  }, []);\r\n\r\n  async function add() {\r\n    await fetch(\"/api/admin/users\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ email, password, role })\r\n    });\r\n    setEmail(\"\"); setPassword(\"\");\r\n    const res = await fetch(\"/api/admin/users\"); const j = await res.json();\r\n    if (j.ok) setUsers(j.users || []);\r\n  }\r\n\r\n  async function del(em) {\r\n    if (!confirm(\"Delete user \" + em + \"?\")) return;\r\n    await fetch(\"/api/admin/users\", { method: \"DELETE\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify({ email: em }) });\r\n    setUsers((s) => s.filter((u) => u.email !== em));\r\n  }\r\n\r\n  return (\r\n    <main>\r\n      <h1>Manage Staff</h1>\r\n      <div className=\"card\">\r\n        <div>\r\n          <input placeholder=\"email\" value={email} onChange={(e) => setEmail(e.target.value)} /> <input placeholder=\"password\" value={password} onChange={(e) => setPassword(e.target.value)} />\r\n          <select value={role} onChange={(e) => setRole(e.target.value)} style={{ marginLeft: 8 }}>\r\n            <option value=\"employee\">employee</option>\r\n            <option value=\"admin\">admin</option>\r\n          </select>\r\n          <button className=\"btn\" onClick={add} style={{ marginLeft: 8 }}>Add</button>\r\n        </div>\r\n        <table style={{ width: \"100%\", marginTop: 12 }}>\r\n          <thead><tr><th>Email</th><th>Role</th><th>Action</th></tr></thead>\r\n          <tbody>\r\n            {users.map((u) => (\r\n              <tr key={u.email}>\r\n                <td style={{ padding: 8 }}>{u.email}</td>\r\n                <td style={{ padding: 8 }}>{u.role}</td>\r\n                <td style={{ padding: 8 }}><button className=\"btn secondary\" onClick={() => del(u.email)}>Delete</button></td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n\r\nexport function getServerSideProps({ req }) {\r\n  const cookies = req.headers.cookie ? parse(req.headers.cookie || \"\") : {};\r\n  const token = cookies.token;\r\n  const user = token ? verifyToken(token) : null;\r\n  if (!user || user.role !== \"admin\") {\r\n    return { redirect: { destination: \"/\", permanent: false } };\r\n  }\r\n  return { props: { user } };\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"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"}}]
}