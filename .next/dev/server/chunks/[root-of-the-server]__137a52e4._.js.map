{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Zayd/Desktop/01_Mandy/lib/db.js"],"sourcesContent":["import fs from \"fs\";\r\nimport path from \"path\";\r\n\r\nconst DB_PATH = path.join(process.cwd(), \"data\", \"db.json\");\r\n\r\nexport async function readDB() {\r\n  const raw = await fs.promises.readFile(DB_PATH, \"utf-8\");\r\n  return JSON.parse(raw);\r\n}\r\n\r\nexport async function writeDB(data) {\r\n  await fs.promises.writeFile(DB_PATH, JSON.stringify(data, null, 2), \"utf-8\");\r\n}\r\n\r\nexport async function findUserByEmail(email) {\r\n  const db = await readDB();\r\n  return db.users.find((u) => u.email === email);\r\n}\r\n\r\nexport async function addUser(user) {\r\n  const db = await readDB();\r\n  db.users.push(user);\r\n  await writeDB(db);\r\n  return user;\r\n}\r\n\r\nexport async function getAvailabilitiesByEmail(email) {\r\n  const db = await readDB();\r\n  if (!db.availabilities) db.availabilities = [];\r\n  return db.availabilities.filter((a) => a.email === email);\r\n}\r\n\r\nexport async function setAvailability(email, date, status) {\r\n  const db = await readDB();\r\n  if (!db.availabilities) db.availabilities = [];\r\n  // remove existing for the date\r\n  db.availabilities = db.availabilities.filter((a) => !(a.email === email && a.date === date));\r\n  if (status) {\r\n    db.availabilities.push({ email, date, status });\r\n  }\r\n  await writeDB(db);\r\n  return true;\r\n}\r\n\r\nexport async function addAttendance(record) {\r\n  const db = await readDB();\r\n  if (!db.attendances) db.attendances = [];\r\n  db.attendances.push(record);\r\n  await writeDB(db);\r\n  return record;\r\n}\r\n\r\nexport async function getAttendanceByEmail(email) {\r\n  const db = await readDB();\r\n  if (!db.attendances) db.attendances = [];\r\n  return db.attendances.filter((a) => a.email === email);\r\n}\r\n\r\nexport async function getAllAttendances() {\r\n  const db = await readDB();\r\n  if (!db.attendances) db.attendances = [];\r\n  return db.attendances;\r\n}\r\n\r\nexport async function setAttendanceApproved(id, approved) {\r\n  const db = await readDB();\r\n  if (!db.attendances) db.attendances = [];\r\n  const rec = db.attendances.find((r) => r.id === id);\r\n  if (!rec) return false;\r\n  rec.approved = !!approved;\r\n  await writeDB(db);\r\n  return true;\r\n}\r\n\r\n// Admin / staff management\r\nexport async function listUsers() {\r\n  const db = await readDB();\r\n  return db.users || [];\r\n}\r\n\r\nexport async function deleteUserByEmail(email) {\r\n  const db = await readDB();\r\n  db.users = (db.users || []).filter((u) => u.email !== email);\r\n  await writeDB(db);\r\n  return true;\r\n}\r\n\r\n// Shifts\r\nexport async function listShifts() {\r\n  const db = await readDB();\r\n  db.shifts = db.shifts || [];\r\n  return db.shifts;\r\n}\r\n\r\nexport async function addShift(shift) {\r\n  const db = await readDB();\r\n  db.shifts = db.shifts || [];\r\n  db.shifts.push(shift);\r\n  await writeDB(db);\r\n  return shift;\r\n}\r\n\r\nexport async function deleteShiftById(id) {\r\n  const db = await readDB();\r\n  db.shifts = (db.shifts || []).filter((s) => s.id !== id);\r\n  await writeDB(db);\r\n  return true;\r\n}\r\n\r\n// Expenses\r\nexport async function listExpenses() {\r\n  const db = await readDB();\r\n  db.expenses = db.expenses || [];\r\n  return db.expenses;\r\n}\r\n\r\nexport async function addExpense(exp) {\r\n  const db = await readDB();\r\n  db.expenses = db.expenses || [];\r\n  // initialize history\r\n  exp.history = exp.history || [{ ts: new Date().toISOString(), action: \"submitted\", by: exp.email }];\r\n  db.expenses.push(exp);\r\n  await writeDB(db);\r\n  return exp;\r\n}\r\n\r\nexport async function getSettings() {\r\n  const db = await readDB();\r\n  db.settings = db.settings || { siteTitle: \"Staff Scheduler\", logo: null };\r\n  return db.settings;\r\n}\r\n\r\nexport async function setSettings(settings) {\r\n  const db = await readDB();\r\n  db.settings = Object.assign(db.settings || {}, settings);\r\n  await writeDB(db);\r\n  return db.settings;\r\n}\r\n\r\n// Admin helpers\r\nexport async function getAllAvailabilities() {\r\n  const db = await readDB();\r\n  db.availabilities = db.availabilities || [];\r\n  return db.availabilities;\r\n}\r\n\r\nexport async function assignUserToShift(shiftId, email) {\r\n  const db = await readDB();\r\n  db.shifts = db.shifts || [];\r\n  const shift = db.shifts.find((s) => s.id === shiftId);\r\n  if (!shift) return false;\r\n  shift.assigned = shift.assigned || [];\r\n  if (!shift.assigned.includes(email)) shift.assigned.push(email);\r\n  await writeDB(db);\r\n  return true;\r\n}\r\n\r\nexport async function setExpenseApproved(id, approved) {\r\n  const db = await readDB();\r\n  db.expenses = db.expenses || [];\r\n  const rec = db.expenses.find((r) => r.id === id);\r\n  if (!rec) return false;\r\n  rec.approved = !!approved;\r\n  rec.history = rec.history || [];\r\n  rec.history.push({ ts: new Date().toISOString(), action: approved ? \"approved\" : \"revoked\" });\r\n  await writeDB(db);\r\n  return true;\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 237, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Zayd/Desktop/01_Mandy/pages/api/settings.js"],"sourcesContent":["import { getSettings } from \"../../lib/db\";\r\n\r\nexport default async function handler(req, res) {\r\n  if (req.method !== \"GET\") return res.status(405).end();\r\n  const settings = await getSettings();\r\n  res.json({ ok: true, settings });\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;AAAA;;AAEe,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,IAAI,IAAI,MAAM,KAAK,OAAO,OAAO,IAAI,MAAM,CAAC,KAAK,GAAG;IACpD,MAAM,WAAW,MAAM,IAAA,iHAAW;IAClC,IAAI,IAAI,CAAC;QAAE,IAAI;QAAM;IAAS;AAChC"}}]
}